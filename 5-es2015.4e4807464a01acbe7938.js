(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{UFnY:function(e,t,o){"use strict";o.r(t);var n=o("ofXK"),r=o("tyNb"),a=o("smFM"),i=o("eSV8"),s=o("tk/3"),c=o("fXoL");let l=(()=>{class e{constructor(e,t){this.http=e,this.authService=t,this.headers=new Headers}getInfoUser(){const e={headers:new s.c({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token"),"X-Platform":"WEB"})};return this.http.post("http://localhost:8080/identity/authentication",null,e)}}return e.\u0275fac=function(t){return new(t||e)(c.Yb(s.a),c.Yb(a.a))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=o("XiUz"),u=o("MSSf"),b=o("IRfi"),h=o("A2Vd"),g=o("Xlwt"),p=o("3Pt+");function m(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",1),c.Ub(1,"div",2),c.Ub(2,"mat-card",3),c.Ub(3,"div",4),c.Ub(4,"mat-card-header",5),c.Ub(5,"mat-card-title",6),c.Fc(6,"Clinic App"),c.Tb(),c.Tb(),c.Tb(),c.Ub(7,"mat-card-content",7),c.Ub(8,"div"),c.Ub(9,"form"),c.Ub(10,"div"),c.Ub(11,"mat-form-field",8),c.Ub(12,"mat-label"),c.Fc(13,"Usuario"),c.Tb(),c.Ub(14,"input",9),c.cc("ngModelChange",(function(t){return c.xc(e),c.gc().userName=t})),c.Tb(),c.Tb(),c.Tb(),c.Ub(15,"div"),c.Ub(16,"mat-form-field",8),c.Ub(17,"mat-label"),c.Fc(18,"Contrase\xf1a"),c.Tb(),c.Ub(19,"input",10),c.cc("ngModelChange",(function(t){return c.xc(e),c.gc().password=t})),c.Tb(),c.Tb(),c.Tb(),c.Ub(20,"div"),c.Ub(21,"button",11),c.cc("click",(function(t){return c.xc(e),c.gc().login()})),c.Fc(22," Iniciar Sesi\xf3n "),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.gc();c.Cb(14),c.oc("ngModel",e.userName),c.Cb(5),c.oc("ngModel",e.password)}}const f=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",component:(()=>{class e{constructor(e,t,o){this._loginService=e,this._authService=t,this.router=o,this.isLoggedIn=!1,this.isLoginFailed=!1}ngOnInit(){console.log(this._loginService.getToken()),this._loginService.getToken()&&(this.isLoggedIn=!0,this.router.navigateByUrl("/system/branch"))}storeFirebaseLoginInfo(e){this._loginService.saveToken(e),this.validateUser()}login(){this._loginService.login(this.userName,this.password).then(e=>{this._loginService.saveUser(e.user.email),e.user.getIdToken().then(e=>{this.storeFirebaseLoginInfo(e)}),this.toDashBoard()}).catch(e=>{if(e.code){this.isLoginFailed=!0;let t="";switch(e.code){case"auth/wrong-password":t="La contrase\xf1a es incorrecta o el usuario a\xfan no cuenta con una contrase\xf1a";break;case"auth/invalid-email":t="La direcci\xf3n de correo no cumple con el formato";break;case"auth/user-not-found":t="No existe un usuario asociado a esta cuenta de correo";break;default:t="Ocurri\xf3 un error inesperado. Contacte con el administrador"}i.a.showError(t)}else i.a.showError("Ocurri\xf3 un error inesperado. Contacte con el administrador")})}toDashBoard(){this.router.navigateByUrl("/system/branch")}validateUser(){this._authService.getInfoUser().subscribe(e=>{console.log("data: ",e),this.isLoginFailed=!1,this.isLoggedIn=!0})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(a.a),c.Ob(l),c.Ob(r.e))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-login"]],features:[c.Bb([a.a])],decls:1,vars:1,consts:[["class","example-login",4,"ngIf"],[1,"example-login"],["fxLayout","row","fxLayoutAlign","center center",1,"login-wrapper"],[1,"box"],[1,"mat-card-header-text"],[1,"mat-card-header-display"],[1,"mat-card-title"],[1,"mat-card-content-login"],[1,"full-width"],["id","userName","name","userName","matInput","","required","",3,"ngModel","ngModelChange"],["id","password","name","password","matInput","","type","password","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary","value","Iniciar Sesi\xf3n",1,"btn-block-login",3,"click"]],template:function(e,t){1&e&&c.Dc(0,m,23,2,"div",0),2&e&&c.oc("ngIf",!t.isLoggedIn)},directives:[n.k,d.c,d.b,u.a,u.c,u.f,u.b,p.t,p.n,p.o,b.b,b.e,h.b,p.b,p.r,p.m,p.p,g.a],styles:[""]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[r.i.forChild(f)],r.i]}),e})();o.d(t,"PublicModule",(function(){return U}));let U=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[n.c,v]]}),e})()}}]);